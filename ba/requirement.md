# 聊天室測試專案需求書

| Version | Date     | Author | Description |
|:-------:|:-------- | ------ | ----------- |
| 1.0.0   | 20210122 | kigi   | Init        |

<!-- @import "[TOC]" {cmd="toc" depthFrom=2 depthTo=3 ordered: false} -->
<!-- code_chunk_output -->

- [1. 專案說明](#1-專案說明)
- [2. 專案範圍](#2-專案範圍)
- [3. 專案名詞](#3-專案名詞)
- [4. 功能需求](#4-功能需求)
  - [4.1 首頁](#41-首頁)
  - [4.2 註冊頁](#42-註冊頁)
  - [4.3 登入頁](#43-登入頁)
  - [4.4 建立聊天室](#44-建立聊天室)
  - [4.5 聊天室](#45-聊天室)
- [5. 資料庫](#5-資料庫)
  - [5.1 會員資料表](#51-會員資料表)
  - [5.2 聊天室資料表](#52-聊天室資料表)
  - [5.3 ER Diagram](#53-er-diagram)

<!-- /code_chunk_output -->

## 1. 專案說明

使用 Web Page 方式，提供聊天室服務，功能包含會員註冊，會員登入，群聊等相關功能。全站使用 HTTPS 提供服務。

## 2. 專案範圍

無

## 3. 專案名詞

無

## 4. 功能需求

### 4.1 首頁

列出目前已有的聊天室。

#### 4.1.1 畫面

@import "index.html"

#### 4.1.2 需求說明

1. 服務網址： `/`, eg: `https://127.0.0.1/`
1. 如果會員目前沒有登入，則顯示 [登入](#login) 與 [註冊](#signup)。
1. 如果會員已經登入，則顯示 __hi, 會員暱稱 [建立聊天室](#create)__，不顯示 [登入](#login) 與 [註冊](#signup)。
1. 一頁只列出 __10__ 筆資料，使用分頁方式呈現。
    1. 分頁按鈕有至 [第一頁](#page_one), [前一頁](#page_prev), [下一頁](#page_next), [最後一頁](#page_last) 等。
    1. 中間部分，最多顯示 __5__ 筆頁數供選擇。如：目前在第一頁，則顯示 1 ~ 5。在第二頁，則顯示 2 ~ 6。以此類推。
1. 點擊 __聊天室名稱__ 則進入聊天室。
    1. 進入前，請先驗證是否有登入過，無則導至登入頁。
1. 點擊 __進入__ 與 點擊 __聊天室名稱__ 同。

### 4.2 註冊頁

供進入使用者註冊。

#### 4.2.1 畫面

@import "signup.html"

#### 4.2.2 需求說明

1. 服務網址: `/signup`, eg: `https://127.0.0.1/signup`
1. e-mail 請驗證 e-mail 格式是否正確。
    1. email 一律轉成小寫。
1. 暱稱最多 20 字，中文，全形或半形英文都算一個字。
1. 密碼至少要 8 字元以上。並用 SHA512 做 Hashcode 儲存。
    1. hash 方式： SHA512(email+password)
1. 點擊 __註冊__ 按鈕，進行註冊。
1. 進資料庫前，請檢查
    1. email 只能是唯一值。
    1. 暱稱不能重覆。
1. 註冊完成後，請回首頁。
1. 如有錯誤，請顯示在該欄位的右方。

### 4.3 登入頁

供已註冊會員登入服務。

#### 4.3.1 畫面

@import "login.html"

#### 4.3.2 需求說明

1. 服務網址: `/login`, eg: `https://127.0.0.1/login`。
1. 登入後，請回首頁。
1. 如有錯誤，請顯示在該欄位的右方。

### 4.4 建立聊天室

供已登入的會員，建立聊天室。

#### 4.4.1 畫面

@import "create_room.html"

#### 4.4.2 需求說明

1. 服務網址: `/create`, eg; `https://127.0.0.1/create`。
1. 請先檢查會員是否登入，沒有登入，則導至登入頁。
1. 聊天室名稱最多 20 字，中文，全形或半形英文都算一個字。
1. 聊天室名稱不能重覆。
1. 建立完成後，請回首頁。
1. 如有錯誤，請顯示在該欄位的右方。

### 4.5 聊天室

供已登入會員群聊。

#### 4.5.1 畫面

@import "chat.html"

#### 4.5.2 需求說明

1. 服務網址: `/room/聊天室編號`, eg: `https://127.0.0.1/room/123`。
1. 請先檢查會員是否有登入，沒有登入，則導至登入頁。
1. 請修改 html 的 title 改成聊天室的名稱。
1. 左側顯示進入聊天室的會員，如有人離開，則需移除。
1. 右側上方顯示聊天訊息。格式為 __會員暱稱__:__訊息__。
1. 右側下面輸入聊天訊息，輸入後，可點擊 __送出__ 按鈕，送出訊息，或按 __ENTER__ 立即送出訊息。
1. 點擊 __離開__ 按鈕，則回首頁。

## 5. 資料庫

資料庫名稱: __cyberon_chatroom__
預設編碼：__utf8mb4__

### 5.1 會員資料表

資料表名稱: __member__。
說明：會員個人資料。

| 欄位名稱 | 資料型別 | 說明
| - | - | -
| id | int primary key auto_increment | 會員編號。
| email | varchar(100) unique key not null | 會員 email。
| password | char(129) not null | 會員密碼。
| nickname | varchar(255) not null | 會員暱稱。
| created | datetime | 建立時間
| updated | datetime | 最後更新時間

### 5.2 聊天室資料表

資料表名稱: __chatroom__。
說明：會員個人資料。

| 欄位名稱 | 資料型別 | 說明
| - | - | -
| id | int primary key auto_increment | 聊天室編號。
| title | varchar(100) unique key not null | 聊天室名稱。
| member_id | int | 會員編號
| created | datetime | 建立時間
| updated | datetime | 最後更新時間

### 5.3 ER Diagram

@import "chatroom.svg"
